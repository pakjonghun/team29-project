<!DOCTYPE html>
<html lang="en">
<head>
    <meta property="og:title" content="ê¸°ì–µë³´ë‹¤ëŠ” ê¸°ë¡ì„"/>
    <meta property="og:description" content="ì–´ì œ ë³´ë‹¤ ë‚˜ì€ ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ ì˜¤ëŠ˜ ê³µë¶€í•œ ê²ƒì„ ê¸°ë¡í•˜ê³ ,  í•¨ê»˜ ê³µìœ í•˜ë©°, ê¸°ë¡í•œ ë‚´ìš©ì„ ë¦¬ë·°í•  ìˆ˜ ìˆëŠ” ì‚¬ì´íŠ¸."/>
    <meta property="og:image" content="{{ url_for('static', filename='ogimage.png') }}"/>

    <meta charset="UTF-8">
    <title>ê¸°ì–µë³´ë‹¤ëŠ” ê¸°ë¡ì„ | ë¡œê·¸ì¸</title>
    <link rel="shortcut icon" href="/static/img/favicon.ico" type="image/x-icon">
    <link href="{{ url_for('static', filename='./css/login.css') }}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script>


        function login() {
            const nickName = $('#nickName').val();
            const password = $('#password').val();
            $.ajax({
                type: "post",
                url: "/user/login",
                data: {nickName, password},
                success: function (response) {
                    const {ok = null, err = null, user = null, token = null} = response;
                    if (ok) {
                        $.cookie('token', token, {path: '/'});
                        alert(`${user.nickName}ë‹˜ ë°©ë¬¸ì„ í™˜ì˜í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ì€ í•˜ë£¨ ë™ì•ˆë§Œ ìœ ì§€ë©ë‹ˆë‹¤.`);
                        window.location.href = "/main";
                    } else {
                        if (err === "1") {
                            alert("ì—†ëŠ” ë‹‰ë„¤ì„ ì…ë‹ˆë‹¤.");
                            $('#nickName').css("border", "1px solid red");

                        } else if (err === "2") {
                            const num = Number($.cookie('wrongPwNum'));
                            alert(`ë¹„ë°€ë²ˆí˜¸ê°€ ${num}ë²ˆ í‹€ë ¸ìŠµë‹ˆë‹¤.`);
                            $('#password').css("border", "1px solid red");

                        } else if (err === "3") {
                            $.cookie('pwToken', token, {path: '/'});
                            alert("ë¹„ë°€ë²ˆí˜¸ 3íšŒ ì˜¤ë¥˜ ì…ë‹ˆë‹¤. 10ì´ˆ í›„ì— ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”")

                        } else if (err === "4") {
                            alert("ë¹„ë°€ë²ˆí˜¸ 3íšŒ í‹€ë¦¬ì…¨ì§€ë§Œ ë‹¤ì‹œ ê¸°íšŒë¥¼ ë“œë¦´ê²Œìš”. ë¡œê·¸ì¸ í•˜ì„¸ìš”.")
                        }
                    }
                }
            })
        }

    </script>
    <style>
        .login {

        }
    </style>
</head>
<body>
<section class="hero">
    <div class="hero-body">
        <p class="title">
            ğŸ“– ê¸°ì–µë³´ë‹¨ ê¸°ë¡ì„
        </p>
    </div>
</section>
<h1 class="warning"> í™”ë©´ì´ ì¢ìŠµë‹ˆë‹¤. ë„“í˜€ì£¼ì„¸ìš”.</h1>
<main class="login">
    <div class="form">
        <input type="text" placeholder="Nickname" required id="nickName">
        <input type="password" placeholder="Password" required id="password">
        <button onclick="login()" class="login_btn">ë¡œê·¸ì¸</button>
    </div>
    <div class="bottom_box">
        <span style="font-size: 0.9em;">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?</span>
        <button onclick="window.location.href='/user/join'">íšŒì›ê°€ì…</button>
    </div>
</main>

<script>
    const id_input = document.querySelector('#nickName');
    const pw_input = document.querySelector('#password');
    const focus = (e) => {
        e.target.style.borderColor = "black";
    }

    const blur = (e) => {
        e.target.style.borderColor = "lightgray"
    }
    id_input.addEventListener("click", focus);
    id_input.addEventListener("blur", blur);
    pw_input.addEventListener("click", focus);
    pw_input.addEventListener("blur", blur);
</script>


</body>
</html>



